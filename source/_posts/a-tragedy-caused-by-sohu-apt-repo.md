title: 坑爹的搜狐软件源以及由软件源引发的连锁反应
date: 2012-12-07 00:50:06
tags:
categories: 我笔我心
---

昨天由搜狐提供了ubuntu官方cn软件源挂了，该返回软件包内容的地方返回了一个中文的网页。而我一台Ubuntu 12.04 LTS的服务器、一台Ubuntu 12.10的PC都使用的是该软件源。由此引发的连锁反应一直持续到了今天。。。

昨天连上ssh，开开心心的apt-get update了一下，结果update的速度巨慢无比，一直在Waiting for header。以为是服务器的问题，于是在Ubuntu的PC上也update了一下，居然是类似的问题。我非常困惑为啥今天的update速度这么慢。回头一看服务器这边，已经结束了，报了一堆错误。但错误的大概意思是说没能成功，继续使用原来旧的数据。由于我急着给服务器装软件，就无视了那个错误，直接install了，没想到居然说这些软件没有认证，是否要强制安装，这可是官方的软件源啊，闹不住啊，于是取消了安装。再看PC这边，update也结束了，也报错了，但错误信息跟服务器不完全相同。于是我在一开始就没往软件源有问题这个方向去想。

<!--more-->

接下来，我花费了超过4个小时的时间，几乎搜遍了整个网络，来试图修复我的apt-get，整个本地list全乱套了，又导致locale也出问题，又导致perl也报错。而此时我还不知道是搜狐的问题，因为程序员的第一反应是“我又哪儿搞错了”你们懂的。我执行了很多命令，有一些我自己都不知道是什么意思，还有一些看起来貌似就不太靠谱，瞎执行一气后，没有效果。。。后来在一个台湾的网站上，有人提到软件源可能正在维护，我连想都没想就忽略了这种可能。直到最后要吐血了，才想起用浏览器访问了一下那个软件源。结果可想而知！！！

骂了搜狐的坑爹软件源10分钟之后，我把两台机器的软件源都换成了163的镜像，把整个lists删掉重建了一下，终于好了。可以update了。晚上又重启了服务器，把内核更新了一下，感觉一切都和谐了~然而我不知道各种问题才刚刚开始。

晚上的晚些时候，我发现ssh连接服务器时中文乱码，我有些困惑，因为服务器上很少有中文的东西，我也不记得之前乱不乱码，我甚至怀疑这些一直都是乱码的，只不过今天我比较强迫，发现了这些不爽的地方。我根本没有怀疑是服务器的设置有问题，以为我下午花了那么大功夫，已经把服务器“修好了”。于是我又研究了一下，改了Mac里ssh的一个配置文件，乱码问题就解决了。我还得以洋洋的把修改Mac配置文件的方法发了[一篇博客](/ios/fix-the-ssh-problem/)。。。

直到今天晚上，昀牛把一个错的离谱的scp命令发给我求指导，我才意外发现服务器上的刚刚下载的带中文的文件名都是乱码。而之前创建的中文文件名则显示正常。联系到之前发生的一系列坑爹情况，我终于确信是服务器的设置出了问题。3个小时之后，我终于意识到是我昨天执行那一堆乱七八糟命令把LC_CTYPE从en_US.UTF8改成了UTF8。我根本都不知道我是怎么改的，又费了好大劲改了回来。。。从目前来看，应该是真的好了。

总结一下，搜狐软件源挂了，我前后至少浪费了6~7个小时的时间去查找问题、尝试解决问题、解决尝试时误操作造成的问题和真的的解决问题。。。我已经无力吐槽了，我只能说，坑！爹！啊！